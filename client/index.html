<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RPS Arena</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- Mobile Block Screen -->
  <div id="mobile-block" class="screen hidden">
    <div class="mobile-message">
      <h1>RPS Arena</h1>
      <p>RPS Arena is designed for desktop.</p>
      <p>Please visit on a computer.</p>
    </div>
  </div>

  <!-- Landing Screen -->
  <div id="landing-screen" class="screen">
    <div class="landing-content">
      <h1 class="logo">RPS ARENA</h1>
      <p class="tagline">Real-time 3-player Rock Paper Scissors</p>
      <p class="description">Entry: 1 USDC | Winner takes 2.4 USDC</p>
      <button id="connect-wallet-btn" class="btn btn-primary">Connect Wallet</button>
      <p class="network-info">Powered by Base</p>
    </div>
  </div>

  <!-- Lobby Browser Screen -->
  <div id="lobby-screen" class="screen hidden">
    <header class="lobby-header">
      <h2>RPS ARENA</h2>
      <nav class="nav-tabs">
        <button id="nav-lobbies" class="nav-tab active">Lobbies</button>
        <button id="nav-leaderboard" class="nav-tab">Leaderboard</button>
        <button id="nav-profile" class="nav-tab">Profile</button>
      </nav>
      <div class="user-info">
        <span id="user-display"></span>
        <button id="disconnect-btn" class="btn btn-link">Disconnect</button>
      </div>
    </header>

    <!-- Lobbies Tab Content -->
    <div id="lobbies-tab" class="tab-content">
      <div class="lobby-content">
        <h3>Select a Lobby</h3>
        <div id="lobby-list" class="lobby-list">
          <!-- Lobbies populated by JS -->
        </div>
        <div class="ping-display">Ping: <span id="ping-value">--</span>ms</div>
      </div>
    </div>

    <!-- Leaderboard Tab Content -->
    <div id="leaderboard-tab" class="tab-content hidden">
      <div class="leaderboard-content">
        <div class="leaderboard-header">
          <h3>Top Players</h3>
          <div class="leaderboard-filters">
            <button id="filter-all" class="filter-btn active">All Time</button>
            <button id="filter-monthly" class="filter-btn">This Month</button>
            <button id="filter-weekly" class="filter-btn">This Week</button>
          </div>
        </div>
        <div id="leaderboard-list" class="leaderboard-list">
          <!-- Leaderboard populated by JS -->
        </div>
      </div>
    </div>

    <!-- Profile Tab Content -->
    <div id="profile-tab" class="tab-content hidden">
      <div class="profile-content">
        <div class="profile-header">
          <div class="profile-photo-container">
            <img id="profile-photo" src="" alt="Profile" class="profile-photo">
            <button id="change-photo-btn" class="btn btn-small hidden">Change Photo</button>
            <input type="file" id="photo-input" accept="image/*" class="hidden">
          </div>
          <div class="profile-info">
            <div class="username-container">
              <span id="profile-username" class="profile-username">-</span>
              <button id="edit-username-btn" class="btn btn-small hidden">Edit</button>
            </div>
            <span id="profile-wallet" class="profile-wallet">-</span>
          </div>
        </div>

        <div id="profile-no-matches" class="profile-notice hidden">
          <p>Complete a match to unlock profile customization!</p>
        </div>

        <div class="profile-stats">
          <div class="stat-card">
            <span class="stat-value" id="stat-matches">0</span>
            <span class="stat-label">Matches</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" id="stat-wins">0</span>
            <span class="stat-label">Wins</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" id="stat-winrate">0%</span>
            <span class="stat-label">Win Rate</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" id="stat-profit">$0.00</span>
            <span class="stat-label">Net Profit</span>
          </div>
          <div class="stat-card">
            <span class="stat-value" id="stat-streak">0</span>
            <span class="stat-label">Best Streak</span>
          </div>
        </div>

        <div class="match-history">
          <h4>Recent Matches</h4>
          <div id="match-history-list" class="match-history-list">
            <!-- Match history populated by JS -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Waiting in Lobby Screen -->
  <div id="waiting-screen" class="screen hidden">
    <div class="waiting-content">
      <h2>Lobby #<span id="current-lobby-id">-</span></h2>
      <div id="player-slots" class="player-slots">
        <!-- Player slots populated by JS -->
      </div>
      <div class="lobby-timer">
        <span id="timeout-display">Waiting for players...</span>
      </div>
      <button id="refund-btn" class="btn btn-secondary hidden">Request Refund</button>
      <p class="waiting-warning">Once you join, your 1 USDC is committed until match starts or 30-minute timeout.</p>
    </div>
  </div>

  <!-- Match Countdown Screen -->
  <div id="countdown-screen" class="screen hidden">
    <canvas id="countdown-canvas"></canvas>
    <div class="countdown-overlay">
      <div id="countdown-number" class="countdown-number">3</div>
      <div id="role-display" class="role-display"></div>
    </div>
  </div>

  <!-- In-Game Screen -->
  <div id="game-screen" class="screen hidden">
    <canvas id="game-canvas"></canvas>
    <div class="game-ping">Ping: <span id="game-ping-value">--</span>ms</div>
  </div>

  <!-- Match Result Screen -->
  <div id="result-screen" class="screen hidden">
    <div class="result-content">
      <h2 id="result-title">VICTORY!</h2>
      <p id="result-payout" class="payout">+2.4 USDC</p>
      <div id="final-standings" class="standings">
        <!-- Standings populated by JS -->
      </div>
      <button id="play-again-btn" class="btn btn-primary">Play Again</button>
    </div>
  </div>

  <!-- Username Edit Modal -->
  <div id="username-modal" class="modal hidden">
    <div class="modal-content">
      <h3>Set Username</h3>
      <p>Choose a unique username (3-20 characters, letters, numbers, underscores only)</p>
      <input type="text" id="username-input" class="text-input" placeholder="Enter username" maxlength="20">
      <p id="username-error" class="error-text hidden"></p>
      <div class="modal-actions">
        <button id="save-username-btn" class="btn btn-primary">Save</button>
        <button id="cancel-username-btn" class="btn btn-secondary">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Payment Modal -->
  <div id="payment-modal" class="modal hidden">
    <div class="modal-content">
      <h3>Join Lobby #<span id="join-lobby-id">-</span></h3>
      <p>Send exactly <strong>1 USDC</strong> to:</p>
      <div class="deposit-address">
        <code id="deposit-address">-</code>
        <button id="copy-address-btn" class="btn btn-small">Copy</button>
      </div>
      <p class="warning">Warning: Once sent, USDC is non-refundable unless the match doesn't start within 1 hour.</p>
      <div class="modal-actions">
        <button id="send-payment-btn" class="btn btn-primary">Send 1 USDC</button>
        <button id="cancel-join-btn" class="btn btn-secondary">Cancel</button>
      </div>
      <div id="payment-status" class="payment-status hidden">
        <span>Waiting for confirmation...</span>
      </div>
    </div>
  </div>

  <!-- Wallet Selection Modal -->
  <div id="wallet-modal" class="modal hidden">
    <div class="modal-content wallet-modal-content">
      <h3>Connect Wallet</h3>
      <p class="wallet-modal-subtitle">Choose your wallet</p>
      <div id="wallet-list" class="wallet-list">
        <!-- Wallets populated by JS via EIP-6963 -->
      </div>
      <div id="no-wallets-message" class="no-wallets-message hidden">
        <p>No wallets detected.</p>
        <p>Please install a Web3 wallet like <a href="https://metamask.io" target="_blank">MetaMask</a> or <a href="https://rabby.io" target="_blank">Rabby</a>.</p>
      </div>
      <button id="cancel-wallet-btn" class="btn btn-secondary">Cancel</button>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/6.11.0/ethers.umd.min.js"></script>
  <script src="src/wallet.js"></script>
  <script src="src/network.js"></script>
  <script src="src/input.js"></script>
  <script src="src/interpolation.js"></script>
  <script src="src/renderer.js"></script>
  <script src="src/ui.js"></script>
  <script src="src/main.js"></script>
</body>
</html>
